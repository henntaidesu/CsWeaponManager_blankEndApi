# 快速开始指南

## 🚀 5分钟快速上手

### 第一步: 启动后端服务

```bash
cd D:\Project\CsWeaponManager\blankEndApi
python blankEndApi.py
```

启动成功后会看到:
```
正在初始化数据库...
✅ 数据库初始化成功: XX/XX 个表
 * Running on http://0.0.0.0:9001
```

**注意**: 首次启动时会自动创建 `yyyp_weapon_classID` 表！

---

### 第二步: 运行测试(可选)

打开新的命令行窗口:

```bash
cd D:\Project\CsWeaponManager\blankEndApi
python test_weapon_classid.py
```

如果看到 "🎉 所有测试通过!" 说明一切正常！

---

### 第三步: 测试API接口

#### 方法1: 使用浏览器
直接访问:
```
http://localhost:9001/youpin898SelectWeaponV1/getWeaponList
```

#### 方法2: 使用Python
```python
import requests

# 获取武器列表
response = requests.get('http://localhost:9001/youpin898SelectWeaponV1/getWeaponList')
print(response.json())
```

#### 方法3: 使用curl
```bash
curl http://localhost:9001/youpin898SelectWeaponV1/getWeaponList
```

---

### 第四步: 从爬虫导入数据

在你的爬虫代码中添加:

```python
import requests
from Spider.src.web_site.youping.select_weapon.select_templateId import selectTemplateId

# 配置
config = {
    'Sessionid': 'your_session',
    'token': 'your_token',
    'app_version': 'your_version',
    'app_type': 'your_type',
    'phone': 'your_phone',
    'userId': 'your_userId',
    'steamId': 'your_steamId'
}

# 获取武器数据
selector = selectTemplateId(config)
weapon_list = selector.getAllTemplateIds(['CSGO_Type_Knife_Unlimited'])

# 发送到后端API
api_url = "http://localhost:9001/youpin898SelectWeaponV1/batchInsertOrUpdate"
response = requests.post(api_url, json=weapon_list)

result = response.json()
print(f"✅ 成功导入 {result['success_count']}/{result['total_count']} 条武器数据")
```

---

## 📋 常用API接口

### 1. 获取所有武器
```python
GET http://localhost:9001/youpin898SelectWeaponV1/getWeaponList
```

### 2. 根据类型查询
```python
GET http://localhost:9001/youpin898SelectWeaponV1/getWeaponByType/匕首
```

### 3. 搜索武器
```python
import requests

response = requests.post(
    'http://localhost:9001/youpin898SelectWeaponV1/searchWeapon',
    json={
        'weapon_type': '匕首',
        'item_name': '多普勒'
    }
)
print(response.json())
```

### 4. 批量插入数据
```python
import requests

weapon_data = [
    {
        'Id': 43705,
        'CommodityName': '弯刀（★） | 多普勒 (崭新出厂)',
        'weapon_type': '匕首',
        'weapon_name': '弯刀（★）',
        'item_name': '多普勒',
        'OnSaleCount': 130,
        'OnLeaseCount': 52
    }
]

response = requests.post(
    'http://localhost:9001/youpin898SelectWeaponV1/batchInsertOrUpdate',
    json=weapon_data
)
print(response.json())
```

---

## 🔍 验证数据库

### 使用SQLite浏览器
1. 下载 [DB Browser for SQLite](https://sqlitebrowser.org/)
2. 打开数据库文件: `blankEndApi/csweaponmanager.db`
3. 查看 `yyyp_weapon_classID` 表

### 使用SQL命令
```python
import sqlite3

conn = sqlite3.connect('blankEndApi/csweaponmanager.db')
cursor = conn.cursor()

# 查看表结构
cursor.execute("PRAGMA table_info(yyyp_weapon_classID)")
print(cursor.fetchall())

# 查看数据
cursor.execute("SELECT * FROM yyyp_weapon_classID LIMIT 10")
for row in cursor.fetchall():
    print(row)

conn.close()
```

---

## ❓ 常见问题

### Q1: 启动时报错 "模块未找到"
**解决**: 确保在 `blankEndApi` 目录下运行命令

### Q2: API返回404
**解决**: 检查URL是否正确，注意大小写

### Q3: 数据没有保存
**解决**: 
1. 检查数据库文件权限
2. 查看控制台错误信息
3. 确认数据格式正确

### Q4: 如何清空表数据
```python
from src.db_manager.yyyp.yyyp_weapon_classID import YyypWeaponClassIDModel

# 删除所有数据
weapons = YyypWeaponClassIDModel.find_all()
for weapon in weapons:
    weapon.delete()
```

---

## 📚 更多文档

- [API完整文档](./README.md) - 所有接口的详细说明
- [完成说明](./完成说明.md) - 项目结构和实现细节

---

## 🎯 下一步

1. ✅ 创建定时任务自动同步武器数据
2. ✅ 在前端添加武器浏览页面
3. ✅ 添加数据统计和分析功能
4. ✅ 实现武器价格监控

---

## 💡 提示

- 后端服务默认运行在 `http://localhost:9001`
- 所有武器相关接口路径前缀: `/youpin898SelectWeaponV1`
- 数据库文件位置: `blankEndApi/csweaponmanager.db`
- 日志文件位置: `blankEndApi/log/`

开始使用吧！ 🎉

